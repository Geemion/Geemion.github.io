<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Windows 异常处理机制学习 | Lyon&#39;s blog</title>
  <meta name="author" content="Lyon">
  
  <meta name="description" content="Walk steps step by step">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Windows 异常处理机制学习"/>
  <meta property="og:site_name" content="Lyon&#39;s blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  #<link href="/favicon.ico" rel="icon">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="Lyon&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="/js/jquery.min.js"></script>
  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?1d807422614f63c8de98cdc3b546860c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
  <script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
    
  <script data-ad-client="ca-pub-6317609007693835" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-66542057-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-66542057-1');
</script>

</head>


<body>
  <!--[if lte IE 8]> <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'> <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode"><img src="http://storage.ie6countdown.com/assets/100/images/banners/warning_bar_0027_Simplified Chinese.jpg" border="0" height="42" width="820" alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today." style='margin-left:auto;margin-right:auto;display: block;'/></a></div> <![endif]-->
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">Lyon&#39;s blog</a></h1>
  <h2><a href="/">I hear and I forget.I see and I remember.I do and I understand.</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
      <li><a href="/about">关于</a></li>
    
	<li> <a href="/atom.xml">RSS</a> </li>
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <time datetime="2015-09-05T13:41:03.000Z"><a href="/2015/09/05/Windows/windows-exception-handling-mechanism/">2015-09-05</a></time>
      
      
  
    <h1 class="title">Windows 异常处理机制学习</h1>
  

    </header>
	
<!-- Table of Contents -->

  <div id="toc" class="toc-article">
  <strong class="toc-title">文章目录</strong>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#关于异常"><span class="toc-number">1.</span> <span class="toc-text">关于异常</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常见异常："><span class="toc-number">1.1.</span> <span class="toc-text">常见异常：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#异常处理机制"><span class="toc-number">1.2.</span> <span class="toc-text">异常处理机制</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows向量化异常处理"><span class="toc-number">2.</span> <span class="toc-text">Windows向量化异常处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Windows结构化异常处理（SEH）"><span class="toc-number">3.</span> <span class="toc-text">Windows结构化异常处理（SEH）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#_try__except"><span class="toc-number">3.1.</span> <span class="toc-text">_try  _except</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SEH嵌套使用"><span class="toc-number">3.2.</span> <span class="toc-text">SEH嵌套使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VS编译器异常处理编译选项"><span class="toc-number">3.3.</span> <span class="toc-text">VS编译器异常处理编译选项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SEH顶层异常处理"><span class="toc-number">3.4.</span> <span class="toc-text">SEH顶层异常处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C++异常处理"><span class="toc-number">4.</span> <span class="toc-text">C++异常处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#调试时如何找到异常处理函数？"><span class="toc-number">5.</span> <span class="toc-text">调试时如何找到异常处理函数？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#后续学习"><span class="toc-number">6.</span> <span class="toc-text">后续学习</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#终结版"><span class="toc-number">7.</span> <span class="toc-text">终结版</span></a></li></ol>
  </div>


	
    <div class="entry">
      
        <p>参考资料：<br>1.Windows核心编程<br>2.<a href="http://bbs.pediy.com/showthread.php?threadid=32222" target="_blank" rel="external">Windows系统程序设计之结构化异常处理</a><br>3.<a href="http://www.cnblogs.com/coffeegg/archive/2011/10/01/2197135.html" target="_blank" rel="external">C++处理异常技巧-try,catch,throw,finally</a><br>4.<a href="http://www.codeceo.com/article/cpp-exception-learn.html" target="_blank" rel="external">深入理解C++中的异常处理机制</a><br>5.<a href="http://www.jtianling.com/%E8%AF%BBwindows%E6%A0%B8%E5%BF%83%E7%BC%96%E7%A8%8B-%E7%BB%93%E6%9E%84%E5%8C%96%E5%BC%82%E5%B8%B8%E9%83%A8%E5%88%86-%E7%90%86%E8%A7%A3%E6%91%98%E8%A6%81.html" target="_blank" rel="external">读windows核心编程,结构化异常部分,理解摘要</a><br>6.<a href="http://bbs.pediy.com/showthread.php?t=173853" target="_blank" rel="external">【原创】白话windows之四 异常处理机制(VEH、SEH、TopLevelEH…)</a></p>
<h2 id="关于异常">关于异常</h2><h3 id="常见异常：">常见异常：</h3><ul>
<li>程序访问一个不可用的内存地址（例如，NULL指针）；</li>
<li>无限递归导致的栈溢出；</li>
<li>向一个较小的缓冲区写入较大块的数据；</li>
<li>类的纯虚函数被调用；</li>
<li>申请内存失败（内存空间不足）；</li>
<li>一个非法的参数被传递给C++函数；</li>
<li>C运行时库检测到一个错误并且需要程序终止执行。</li>
<li>访问的对象（文件等）或则地址不存在</li>
<li>等等。。。。。<br>根据异常作用或则产生后后果可以将异常分为错误（重新执行产生异常的指令如页面错误）、陷阱（执行下一条指令如调试断点）和终止（进程终止或则系统崩溃）。<a id="more"></a>
当异常发生后我们可以通过GetExceptionCode获得异常号[其实就和GetLasterro效果相同]，通过这个异常号可以查询到异常发生的相关信息。(这里有个调试时候的小技巧当调试时在调试选项将监视窗口调出，然后在监视窗口设置 名称“$ERR,hr” 当动态调试时不管是Getlasterr的值还是GetExceptionCode值都将显示在后面值中。这样就不用导出Getlasterrno了)。</li>
</ul>
<h3 id="异常处理机制">异常处理机制</h3><p>Windows中主要两种异常处理机制，Windows异常处理（VEH、SEH）和C++异常处理。<br>Windows异常处理结构未公开的，包含向量化结构异常VEH及结构化异常处理SEH。由操作系统提供的服务，当一个线程出现错误时，操作系统调用用户定义的一个回调函数_exept_handler。回调函数接收到操作系统传递过来的许多有价值的信息，例如异常的类型和发生的地址。使用这些信息，异常回调函数就能决定下一步做什么。<br>C++异常处理是C++语言的特性，在Windows平台上由系统提供支持（我是这么理解的）。<br><strong>Windows异常处理顺序流程</strong></p>
<ul>
<li>终止当前程序的执行</li>
<li>调试器(进程必须被调试,向调试器发送EXCEPTION_DEBUG_EVENT消息)</li>
<li>执行VEH</li>
<li>执行SEH</li>
<li>TopLevelEH(进程被调试时不会被执行)</li>
<li>执行VEH</li>
<li>交给调试器(上面的异常处理都说处理不了，就再次交给调试器)</li>
<li>调用异常端口通知csrss.exe</li>
</ul>
<h2 id="Windows向量化异常处理">Windows向量化异常处理</h2><p>向量异常处理（Vectored Exception Handling (VEH)）是结构化异常处理的扩展，它是在XP中被引进的。VEH优先权高于SEH,只有所有VEH全不处理某个异常的时候,异常处理权才会到达SEH。每当操作系统发生异常的时候，系统会检测进程的PEB结构中的EnvironmentUpdateCount元素，当PEB. EnvironmentUpdateCount符合要求的时候，系统将会遍历VEH异常链表，VEH链表中的异常处理函数会得到执行，各个VEH中的异常处理函数顺序执行。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AddVectoredExceptionHandler添加的函数会在SEH异常函数之前执行</span></span><br><span class="line"><span class="function">PVOID WINAPI <span class="title">AddVectoredExceptionHandler</span><span class="params">(</span><br><span class="line">_In_  ULONG FirstHandler,                          是否将VEH函数插入到VEH链表头，插入到链表头的函数先执行  <span class="number">1</span>表示头部 <span class="number">0</span>表示尾部</span><br><span class="line">_In_  PVECTORED_EXCEPTION_HANDLER VectoredHandler  异常处理函数指针</span><br><span class="line">)</span></span>;</span><br><span class="line"><span class="comment">//AddVectoredContinueHandler添加的函数，会在SEH异常函数之后执行</span></span><br><span class="line"><span class="function">PVOID WINAPI <span class="title">AddVectoredContinueHandler</span><span class="params">(</span><br><span class="line">_In_  ULONG FirstHandler,</span><br><span class="line">_In_  PVECTORED_EXCEPTION_HANDLER VectoredHandler</span><br><span class="line">)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">LONG NTAPI <span class="title">FirstVectExcepHandler</span><span class="params">( PEXCEPTION_POINTERS pExcepInfo )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>( ... )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> EXCEPTION_CONTINUE_EXECUTION;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> EXCEPTION_CONTINUE_SEARCH;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//参数1=1表示插入Veh链的头部，=0表示插入到VEH链的尾部</span></span><br><span class="line">AddVectoredExceptionHandler( <span class="number">1</span>, &amp;FirstVectExcepHandler );</span><br></pre></td></tr></table></figure></p>
<p>VEH处理函数可以返回的值：EXCEPTION_CONTINUE_SEARCH、EXCEPTION_CONTINUE_EXECUTION。<br>返回EXCEPTION_EXECUTE_HANDLER是无效的，等同于EXCEPTION_CONTINUE_SEARCH。当一个Veh返回EXCEPTION_CONTINUE_SEARCH，则把异常交给下一个VEH处理。如果返回EXCEPTION_CONTINUE_EXECUTION，认为已经被处理，退出异常处理器在异常指令处继续执行。<br>VEH对本进程中的任意一个线程有效。</p>
<h2 id="Windows结构化异常处理（SEH）">Windows结构化异常处理（SEH）</h2><p>SEH使用_try、_except、_finally和_leave关键字和RaiseException API  EXCEPTION_EXECUTE_HANDLER，SEH是基于线程栈的异常处理机制，所以它只能处理自己线程的异常（但是顶层异常处理对所有线程有效）。</p>
<p>###_try  _finally<br>基本结构<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__try </span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// 受保护的代码</span></span><br><span class="line">&#125;</span><br><span class="line">__finally</span><br><span class="line"> &#123;</span><br><span class="line"> <span class="comment">// 结束处理程序</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>这个结构可能是SEH机制中我使用最多的，加上__leave关键字使用起来太方便了。try块可能会因为return，goto，异常等非自然退出，也可能会因为成功执行而自然退出。但不论try块是如何退出的，finally块的内容都会被执行【注意：对于使用ExitProcess或则进程被其他进程终止的情况finally块将不会被执行】。这样我们就可以在finally块中做一些清理工作，不用每次都判断或则使用goto语句。有多方便呢，看下面的图就知道了。<a href="http://bbs.pediy.com/showthread.php?threadid=32222" target="_blank" rel="external">图片出处</a>【这篇文章写得非常好，推荐看这篇这里我只是总结哈自己所学。。。】</p>
<div align="center"><br><img src="/img/finally.jpg" align="center"><br></div>

<h3 id="_try__except">_try  _except</h3><p>基本结构<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__try </span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">// 受保护的代码</span></span><br><span class="line">&#125;</span><br><span class="line">__except ( <span class="comment">/*异常过滤器exception filter*/</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 异常处理程序exception handler，</span></span><br><span class="line">  <span class="comment">//这里的代码只有当try块中发生异常才执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>_except ( /<em>异常过滤器exception filter</em>/ )中的异常过滤器取值：<br>EXCEPTION_EXECUTE_HANDLER(1):    代码执行__except块中的代码，该异常被处理，一般我都写这个<br>EXCEPTION_CONTINUE_SEARCH(0):    表示继续搜索上一个异常过滤器,由上一级来处理.<br>EXCEPTION_CONTINUE_EXECUTION(-1):程序试图重新执行引发异常的代码,因为exception可以用一个函数代替,函数的返回值就是exception的值,所以可以在函数中进行一些操作使用原语句可以正确执行,但是并不推荐这样做.<br>通俗语言版：<br>EXCEPTION_EXECUTE_HANDLER(1): 这是告诉系统， 我认识这个异常，请执行我的异常处理代码，然后从接下来的第一行代码开始继续执行<br>EXCEPTION_CONTINUE_SEARCH(0): 这个是告诉系统， 我不认识这个异常， 请继续往外抛异常，让别人处理<br>EXCEPTION_CONTINUE_EXECUTE(-1): 这个是告诉系统， 我已经在调用filter时修正了这个异常， 请从发生异常的地方继续执行<br>这个值我们也可以根据具体情况选择，比如下面这个例子<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__try &#123;</span><br><span class="line">   ……</span><br><span class="line">&#125;</span><br><span class="line">__except ( MyFilter( GetExceptionCode() ) )</span><br><span class="line">&#123;</span><br><span class="line">   ……</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LONG <span class="title">MyFilter</span> <span class="params">( DWORD dwExceptionCode )</span></span><br><span class="line"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( dwExceptionCode == EXCEPTION_ACCESS_VIOLATION )</span><br><span class="line">    <span class="keyword">return</span> EXCEPTION_EXECUTE_HANDLER ;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> EXCEPTION_CONTINUE_SEARCH ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>例子中根据传递过来的不同异常结果选择不同的异常过滤器。<br>这三个不同的过滤处理器处理流程如下图</p>
<div align="center"><br><img src="/img/except.gif" align="center"><br></div>

<p>try finally主要还是编译器做工作，而exception主要是操作系统的工作。</p>
<h3 id="SEH嵌套使用">SEH嵌套使用</h3><p>当程序中存在多个异常处理结构嵌套时就涉及到全局展开、局部展开的问题了，根据不同的异常过滤值有不同的展开方式。具体有多复杂请看参考资料</p>
<h3 id="VS编译器异常处理编译选项">VS编译器异常处理编译选项</h3><p>在VC中，你可能会发现一个怪异的现象，就是try-catch块无法捕获像“除0”、“空指针访问”之类的异常。原来，在VC中一般的错误和异常都是用SEH来处理的，不等同于throw抛出的异常。而try-catch对结构化异常的处理，是由编译参数EH来控制的。</p>
<table>
<thead>
<tr>
<th style="text-align:right">参数</th>
<th style="text-align:center">无EH参数</th>
<th style="text-align:center">EHs(EHsc)</th>
<th style="text-align:center">EHa(Ehac)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">try-catch</td>
<td style="text-align:center">不处理异常</td>
<td style="text-align:center">只处理C++标准异常，代码优化较好</td>
<td style="text-align:center">处理C++标准异常和结构化异常，代码优化较差</td>
</tr>
<tr>
<td style="text-align:right">_try _except(vs2005及以后)</td>
<td style="text-align:center">处理C++标准异常和结构化异常</td>
<td style="text-align:center">处理C++标准异常和结构化异常</td>
<td style="text-align:center">处理C++标准异常和结构化异常</td>
</tr>
<tr>
<td style="text-align:right">_try _except(vs2005之前)</td>
<td style="text-align:center">只处理结构化异常</td>
<td style="text-align:center">只处理结构化异常</td>
<td style="text-align:center">只处理结构化异常</td>
</tr>
</tbody>
</table>
<h3 id="SEH顶层异常处理">SEH顶层异常处理</h3><p>顶层的SEH异常处理函数对这个进程中所有线程都是有效的，所以只用在main()函数开始的地方设置一次就够了。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LONG WINAPI <span class="title">MyUnhandledExceptionFilter</span><span class="params">(PEXCEPTION_POINTERS pExceptionPtrs)</span> </span><br><span class="line"> </span>&#123; </span><br><span class="line"><span class="comment">// Do something, for example generate error report </span></span><br><span class="line"><span class="comment">//.. </span></span><br><span class="line"><span class="comment">// Execute default exception handler next return EXCEPTION_EXECUTE_HANDLER; </span></span><br><span class="line"> &#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"> </span>&#123; </span><br><span class="line"> SetUnhandledExceptionFilter(MyUnhandledExceptionFilter); </span><br><span class="line"> <span class="comment">// .. some unsafe code here</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>顶层异常处理函数也可以返回三个值：EXCEPTION_CONTINUE_SEARCH、EXCEPTION_EXECUTE_HANDLER、EXCEPTION_CONTINUE_EXECUTION。<br>返回EXCEPTION_CONTINUE_EXECUTION时，和SEH一样。<br>返回EXCEPTION_EXECUTE_HANDLER时，则直接杀死该进程。<br>返回EXCEPTION_CONTINUE_SEARCH时，会查注册表，检查是否存在实时调试器。注册表路径：KLM\software\microsoft\windows nt\currentvsrsion\aedebug。如果Auto==1，Debugger!=NULL则根据Debugger中指示的参数启动实时调试器，让调试器处理该异常。（如果不存在顶层异常且进程没被调试，也会检查并启动实时调试器）</p>
<h2 id="C++异常处理">C++异常处理</h2><p>先看一个C++未处理异常的例子<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Up&#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> Fit&#123;&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">g</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">//异常规格说明，f函数只能抛出Up 和Fit类型的异常</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> i)</span><span class="title">throw</span><span class="params">(Up,Fit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span>(i) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">throw</span> Up();</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">throw</span> Fit();    </span><br><span class="line">    &#125;</span><br><span class="line">    g();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">g</span><span class="params">()</span> </span>&#123;<span class="keyword">throw</span> <span class="number">47</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_ternminate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"I am a ternminate"</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">my_unexpected</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"unexpected exception thrown"</span> &lt;&lt; endl;</span><br><span class="line"> <span class="comment">//   throw Up();</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="number">8</span>;</span><br><span class="line">    <span class="comment">//如果在unexpected中继续抛出异常，抛出的是规格说明中的　则会被捕捉程序继续执行</span></span><br><span class="line">    <span class="comment">//如果抛出的异常不在异常规格说明中分两种情况</span></span><br><span class="line">    <span class="comment">//1.异常规格说明中有bad_exception ，那么会导致抛出一个bad_exception</span></span><br><span class="line">    <span class="comment">//2.异常规格说明中没有bad_exception 那么会导致程序调用ternminate函数</span></span><br><span class="line">   <span class="comment">// exit(0);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"> set_terminate(my_ternminate);</span><br><span class="line"> set_unexpected(my_unexpected);</span><br><span class="line"> <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;=<span class="number">3</span>;i++)</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="comment">//当抛出的异常,并不是异常规格说明中的异常时</span></span><br><span class="line">     <span class="comment">//会导致最终调用系统的unexpected函数，通过set_unexpected可以</span></span><br><span class="line">     <span class="comment">//用来设置自己的unexpected汗函数</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        f(i);    </span><br><span class="line">    &#125;<span class="keyword">catch</span>(Up) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Up caught"</span> &lt;&lt; endl;    </span><br><span class="line">    &#125;<span class="keyword">catch</span>(Fit) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"Fit caught"</span> &lt;&lt; endl;    </span><br><span class="line">    &#125;<span class="keyword">catch</span>(bad_exception) &#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"bad exception"</span> &lt;&lt; endl;    </span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="调试时如何找到异常处理函数？">调试时如何找到异常处理函数？</h2><ul>
<li>SEH头部保存在TEB中，可以通过TEB（fs:[0]）找到seh头部然后找到异常处理函数（还没深入研究）</li>
<li><a href="http://bbs.pediy.com/showthread.php?t=211188" target="_blank" rel="external">VEH函数入口的快速定位</a></li>
</ul>
<h2 id="后续学习">后续学习</h2><p><a href="http://www.jtianling.com/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E4%B8%8Eminidump%E8%AF%A6%E8%A7%A3-1-c-%E5%BC%82%E5%B8%B8.html" target="_blank" rel="external">异常处理与MiniDump详解(1) C++异常</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line">HandleWithoutCrash例子：</span><br><span class="line"></span><br><span class="line">#include &lt;windows.h&gt;</span><br><span class="line">#include &lt;Dbghelp.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"> </span><br><span class="line">#pragma auto_inline (off)</span><br><span class="line">#pragma comment( lib, "DbgHelp" )</span><br><span class="line"> </span><br><span class="line">// 为了程序的简洁和集中关注关心的东西，按示例程序的惯例忽略错误检查，实际使用时请注意</span><br><span class="line">LONG WINAPI MyUnhandledExceptionFilter(</span><br><span class="line">struct _EXCEPTION_POINTERS* ExceptionInfo</span><br><span class="line">    )</span><br><span class="line">&#123;</span><br><span class="line">    HANDLE lhDumpFile = CreateFile(_T("DumpFile.dmp"), GENERIC_WRITE, 0, NULL, CREATE_ALWAYS,FILE_ATTRIBUTE_NORMAL ,NULL);</span><br><span class="line"> </span><br><span class="line">    MINIDUMP_EXCEPTION_INFORMATION loExceptionInfo;</span><br><span class="line">    loExceptionInfo.ExceptionPointers = ExceptionInfo;</span><br><span class="line">    loExceptionInfo.ThreadId = GetCurrentThreadId();</span><br><span class="line">    loExceptionInfo.ClientPointers = TRUE;</span><br><span class="line">    MiniDumpWriteDump(GetCurrentProcess(), GetCurrentProcessId(),lhDumpFile, MiniDumpNormal, &amp;loExceptionInfo, NULL, NULL);</span><br><span class="line"> </span><br><span class="line">    CloseHandle(lhDumpFile);</span><br><span class="line"> </span><br><span class="line">    return EXCEPTION_EXECUTE_HANDLER;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">void Fun2()</span><br><span class="line">&#123;</span><br><span class="line">    __try</span><br><span class="line">    &#123;</span><br><span class="line">       static bool b = false;</span><br><span class="line">      </span><br><span class="line">       if(!b)</span><br><span class="line">       &#123;</span><br><span class="line">           b = true;</span><br><span class="line">           int *p = NULL;</span><br><span class="line">           *p = 0;</span><br><span class="line">        &#125;</span><br><span class="line">       else</span><br><span class="line">       &#123;</span><br><span class="line">           MessageBox(NULL, _T("Here"), _T(""), MB_OK);</span><br><span class="line">       &#125;</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">    __except(MyUnhandledExceptionFilter(GetExceptionInformation()))</span><br><span class="line">    &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">void Fun()</span><br><span class="line">&#123;</span><br><span class="line">    Fun2();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">    Fun();</span><br><span class="line">    Fun();</span><br><span class="line"> </span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">调用SetUnhandledExceptionFilter设置SEH异常处理函数</span><br><span class="line">调用_set_purecall_handler设置处理纯虚函数调用导致的错误的处理函数</span><br><span class="line">调用_set_se_translator()处理C++异常</span><br><span class="line">调用_set_new_handler设置new失败导致的错误的处理函数</span><br><span class="line">调用_set_new_mode设置malloc失败导致的错误的处理函数</span><br><span class="line">调用_set_invalid_parameter_handler设置CRT无效参数导致的错误的处理函数</span><br><span class="line">调用signal设置信号SIGABRT、SIGINT、SIGTERM的处理函数</span><br><span class="line">调用set_terminate设置terminate处理函数，适用于CRT，这个只对当前线程有效</span><br><span class="line">调用set_unexpected设置unexpected处理函数。这个也是只对当前线程有效</span><br><span class="line">调用signal设置信号SIGFPE、SIGILL、SIGSEGV的处理函数。这个也是对当前线程有效</span><br><span class="line">守护进程:https://github.com/mkdym/DaemonSvc</span><br><span class="line">*/</span><br><span class="line">#include &lt;Strsafe.h&gt;</span><br><span class="line">#include &lt;DbgHelp.h&gt;</span><br><span class="line">LONG __stdcall MyExceptionFun( LPEXCEPTION_POINTERS lpExcept)</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	//SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER(MyExceptionFun));</span><br><span class="line"></span><br><span class="line">	// EXCEPTION_EXECUTE_HANDLER equ 1 表示我已经处理了异常,可以优雅地结束了  </span><br><span class="line">	// EXCEPTION_CONTINUE_SEARCH equ 0 表示我不处理,其他人来吧,于是windows调用默认的处理程序显示一个错误框,并结束  </span><br><span class="line">	//EXCEPTION_CONTINUE_EXECUTION equ -1 表示错误已经被修复,请从异常发生处继续执行 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	//如果存在调试器则继续到上一层的try-except域中继续查找一个恰当的__except模块</span><br><span class="line">	if (IsDebuggerPresent())</span><br><span class="line">	&#123;</span><br><span class="line">		return EXCEPTION_CONTINUE_SEARCH;</span><br><span class="line">	&#125;</span><br><span class="line">	typedef BOOL (WINAPI * MiniDumpWriteDumpT)( </span><br><span class="line">		HANDLE,</span><br><span class="line">		DWORD ,</span><br><span class="line">		HANDLE ,</span><br><span class="line">		MINIDUMP_TYPE ,</span><br><span class="line">		PMINIDUMP_EXCEPTION_INFORMATION ,</span><br><span class="line">		PMINIDUMP_USER_STREAM_INFORMATION ,</span><br><span class="line">		PMINIDUMP_CALLBACK_INFORMATION</span><br><span class="line">		);</span><br><span class="line">	wchar_t wszCurDir[MAX_PATH]=&#123;0&#125;,wszMiniDumpPath[MAX_PATH*2]=&#123;0&#125;,wszTime[60]=&#123;0&#125;;</span><br><span class="line">	SYSTEMTIME sys=&#123;0&#125;;</span><br><span class="line"></span><br><span class="line">	MiniDumpWriteDumpT pfnMiniDumpWriteDump = NULL;</span><br><span class="line">	HMODULE hDbgHelp = LoadLibraryW(L"DbgHelp.dll");</span><br><span class="line">	if (hDbgHelp)</span><br><span class="line">		pfnMiniDumpWriteDump = (MiniDumpWriteDumpT)GetProcAddress(hDbgHelp,"MiniDumpWriteDump");</span><br><span class="line"></span><br><span class="line">	MessageBoxW(NULL,L"Error，请将当前exe文件目录dmp发送给开发者寻求帮助，谢谢！",NULL, MB_ICONERROR);</span><br><span class="line"></span><br><span class="line">	HANDLE hProcess=GetCurrentProcess();</span><br><span class="line">	DWORD dwProcessID=GetProcessId(hProcess);</span><br><span class="line">	GetCurrentDirectory(sizeof(wszCurDir),wszCurDir);</span><br><span class="line">	GetLocalTime( &amp;sys );</span><br><span class="line">	StringCchPrintf(wszTime,60,L"%4d%02d%02d%02d%02d%02d", sys.wYear,sys.wMonth,sys.wDay,sys.wHour,sys.wMinute,sys.wSecond);</span><br><span class="line">	StringCchPrintf(wszMiniDumpPath,MAX_PATH*2,L"%ws\\MiniDump%ws.dmp",wszCurDir,wszTime);</span><br><span class="line"></span><br><span class="line">	HANDLE hFile=CreateFileW(wszMiniDumpPath, GENERIC_WRITE, FILE_SHARE_WRITE, NULL, CREATE_ALWAYS, FILE_ATTRIBUTE_NORMAL, NULL);</span><br><span class="line">	if ( INVALID_HANDLE_VALUE!=hFile &amp;&amp; GetLastError()!=ERROR_ALREADY_EXISTS &amp;&amp;pfnMiniDumpWriteDump!=NULL)</span><br><span class="line">	&#123;</span><br><span class="line">		MINIDUMP_EXCEPTION_INFORMATION mei;</span><br><span class="line">		mei.ThreadId=GetCurrentThreadId();</span><br><span class="line">		mei.ExceptionPointers=lpExcept;</span><br><span class="line">		mei.ClientPointers=FALSE;</span><br><span class="line">		pfnMiniDumpWriteDump(hProcess, dwProcessID, hFile, MiniDumpWithProcessThreadData, &amp;mei, NULL, NULL);</span><br><span class="line">		CloseHandle(hFile);</span><br><span class="line">	&#125;</span><br><span class="line">	return EXCEPTION_EXECUTE_HANDLER;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="终结版">终结版</h2><p>大家想学习Windows的异常处理直接就看这个吧<a href="http://www.codeproject.com/Articles/207464/Exception-Handling-in-Visual-Cplusplus" target="_blank" rel="external">Effective Exception Handling in Visual C++</a>,没有比这更好的了。<a href="https://github.com/geemion/Exception-Handling-in-Visual-C-" target="_blank" rel="external">中文版</a>,都和我没关系……….<br>更多详细信息<br><a href="http://www.codeproject.com/Articles/zexspectrum#Article" target="_blank" rel="external">……</a><br><a href="https://sourceforge.net/projects/crashrpt/?source=typ_redirect" target="_blank" rel="external">CrashRpt</a><br><a href="http://blog.csdn.net/vagrxie/article/details/4317423" target="_blank" rel="external">异常处理与MiniDump详解(1) C++异常</a><br><a href>软件调试-第24章 异常处理代码的编译</a><br><a href="http://bbs.pediy.com/showthread.php?t=65783" target="_blank" rel="external">SEH学习报告</a></p>

      
    </div>
    <footer>
      

        
          <div class="alignleft post-nav">
            <em>上一篇: </em><a href="/2015/09/20/Windows/right-way-to-get-windows-version-on-win10/">获得Windows系统版本信息的正确姿势On Windows10</a>
          </div>
        
        
          <div class="alignright post-nav">
            <em>下一篇: </em><a href="/2015/08/25/Windows/VC-BMPtoJPG/">VC++直接利用api实现bmp图像转jpg图像</a>
          </div>
          <div class="clearfix"></div>
        

        
          <div class="copyright">
            
              <span class="claim">转载请注明youngroe.com</span>
            
            
              <span class="from-link">
                <em>本文链接地址:</em>
                <a href="/2015/09/05/Windows/windows-exception-handling-mechanism/">
                  http://www.youngroe.com/2015/09/05/Windows/windows-exception-handling-mechanism/
                </a>
              </span>
            
          </div>
        
        
  
  <div class="categories">
    <a href="/categories/Windows/">Windows</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/SEH/">SEH</a>, <a href="/tags/Windows/">Windows</a>, <a href="/tags/异常处理/">异常处理</a>
  </div>

        
          <! -- 添加捐赠图标 -->
<div class ="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a>
        <span class="donate_txt">
           ↑<br>
           欣赏此文？求鼓励，求支持！
        </span>
        <br>
      </div>  
    <div id="donate_guide" class="donate_bar center hidden" >
        <!-- 方式一： 
            ![](/img/Alipay.jpg)
            ![](/img/WeChatpay.jpg)
        -->
        <!-- 方式二；
            step1：在_config.yml中添加配置
                Alipay: /img/Alipay.jpg
                WeChatpay: /img/WeChatpay.jpg
            step2：此处两张图片的路径分别设置为如下
                <img src="undefined"
                <img src="undefined"
        -->
        <!-- 支付宝打赏图案 -->
        <img src="/img/Alipay.png" alt="支付宝打赏">
        <!-- 微信打赏图案 -->
        <img src="/img/WeChatpay.png" alt="微信打赏">
    </div>
    <script type="text/javascript">
        document.getElementById('btn_donate').onclick = function(){
            $('#donate_board').addClass('hidden');
            $('#donate_guide').removeClass('hidden');
        }
    </script>
</div>
<! -- 添加捐赠图标 -->
        
        <div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js"></script>
<script type="text/javascript">
    var gitalk = new Gitalk({
  clientID: '503c39aa3fb2b8c1b734',
  clientSecret: '65d784ff7a95a9dbf4a4208c9e32166ca29654f2',
  repo: 'geemion.github.io',
  owner: 'geemion',
  admin: 'geemion',
  pagerDirection:'first',
  id: md5(window.location.pathname)
})

gitalk.render('gitalk-container')
</script>
      
      <div class="clearfix"></div>
    </footer>
  </div>
  <div id="container"></div>
</span>
</article>


<section id="comment">
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/Cybersecurity/">Cybersecurity</a><small>6</small></li>
  
    <li><a href="/categories/Debug/">Debug</a><small>7</small></li>
  
    <li><a href="/categories/IOT/">IOT</a><small>10</small></li>
  
    <li><a href="/categories/Kernel/">Kernel</a><small>4</small></li>
  
    <li><a href="/categories/Learning/">Learning</a><small>5</small></li>
  
    <li><a href="/categories/Life/">Life</a><small>5</small></li>
  
    <li><a href="/categories/Others/">Others</a><small>1</small></li>
  
    <li><a href="/categories/Tools/">Tools</a><small>5</small></li>
  
    <li><a href="/categories/Vulnerabilities/">Vulnerabilities</a><small>0</small></li>
  
    <li><a href="/categories/Windows/">Windows</a><small>13</small></li>
  
    <li><a href="/categories/life/">life</a><small>0</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">最新文章</h3>
  <ul class="entry">
    
      <li>
        <a href="/2021/10/20/IOT/using-rasberrypi-as-poor-mans-hardware-hacking-tool/">树莓派-穷人的硬件黑客工具（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/23/IOT/iot-security-part-8-introduction-to-software-defined-radio-sdr/">物联网安全101-8.软件无线电（Software Defined Radio，SDR）简介（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/23/IOT/iot-security-part-7-reverse-engineering-an-iot-firmware/">物联网安全101-7.物联网固件逆向（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/22/IOT/iot-security-part-6-101-zigbee-security-101/">物联网安全101-6.ZigBee安全（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/22/IOT/iot-security-part-5-101-zigbee-protocol-101/">物联网安全101-5.ZigBee协议（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/22/IOT/iot-security-part-4-101-bluetooth-low-energy-101/">物联网安全101-4.低功耗蓝牙BLE（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/22/IOT/iot-security-part-3-101-iot-top-ten-vulnerabilities/">物联网安全101-3.物联网10大安全漏洞（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/21/IOT/iot-security-part-2-101-iot-attack-surface/">物联网安全101-2.物联网攻击面（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/09/21/IOT/iot-security-part-1-101-iot-introduction-architecture/">物联网安全101-1.物联网介绍及其架构（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/08/20/Cybersecurity/guide-linux-privilege-escalation/">Linux权限提升指南（翻译）</a>
      </li>
    
      <li>
        <a href="/2021/03/20/IOT/powerpc_binary_blob_firmware_reverse/">一次嵌入式固件逆向实践</a>
      </li>
    
      <li>
        <a href="/2020/10/02/Cybersecurity/art-of-anti-detection-4-art-of-anti-detection-4-self-defense/">反检测的艺术4-自保护（翻译）</a>
      </li>
    
  </ul>
</div>


  
<div class="widget tagcloud">
  <h3 class="title">标签云</h3>
  <div class="entry">
    <a href="/tags/Boost/" style="font-size: 10px;">Boost</a> <a href="/tags/DDoS/" style="font-size: 10px;">DDoS</a> <a href="/tags/DNS-over-HTTPS/" style="font-size: 10px;">DNS-over-HTTPS</a> <a href="/tags/DNS劫持/" style="font-size: 10px;">DNS劫持</a> <a href="/tags/Delphi/" style="font-size: 10px;">Delphi</a> <a href="/tags/Dll劫持/" style="font-size: 10px;">Dll劫持</a> <a href="/tags/GetVersionEx/" style="font-size: 10px;">GetVersionEx</a> <a href="/tags/Http/" style="font-size: 10px;">Http</a> <a href="/tags/IDA-Pro/" style="font-size: 12px;">IDA Pro</a> <a href="/tags/IOT安全/" style="font-size: 18px;">IOT安全</a> <a href="/tags/Linux/" style="font-size: 14px;">Linux</a> <a href="/tags/MSDN/" style="font-size: 12px;">MSDN</a> <a href="/tags/Malware/" style="font-size: 12px;">Malware</a> <a href="/tags/MiniDumpWriteDump/" style="font-size: 10px;">MiniDumpWriteDump</a> <a href="/tags/PEB/" style="font-size: 10px;">PEB</a> <a href="/tags/Procmon/" style="font-size: 10px;">Procmon</a> <a href="/tags/Runtime-Error/" style="font-size: 10px;">Runtime Error</a> <a href="/tags/SEH/" style="font-size: 10px;">SEH</a> <a href="/tags/SysinternalsSuite/" style="font-size: 10px;">SysinternalsSuite</a> <a href="/tags/Tips/" style="font-size: 10px;">Tips</a> <a href="/tags/UAC/" style="font-size: 10px;">UAC</a> <a href="/tags/UAF漏洞/" style="font-size: 10px;">UAF漏洞</a> <a href="/tags/VC/" style="font-size: 10px;">VC</a> <a href="/tags/Visual-Studio/" style="font-size: 12px;">Visual Studio</a> <a href="/tags/Windbg/" style="font-size: 10px;">Windbg</a> <a href="/tags/Windows/" style="font-size: 20px;">Windows</a> <a href="/tags/getaddrinfo/" style="font-size: 10px;">getaddrinfo</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/libeay32/" style="font-size: 10px;">libeay32</a> <a href="/tags/x64/" style="font-size: 10px;">x64</a> <a href="/tags/内核/" style="font-size: 12px;">内核</a> <a href="/tags/内核结构/" style="font-size: 14px;">内核结构</a> <a href="/tags/反病毒/" style="font-size: 16px;">反病毒</a> <a href="/tags/安全机制/" style="font-size: 10px;">安全机制</a> <a href="/tags/异常处理/" style="font-size: 10px;">异常处理</a> <a href="/tags/提权/" style="font-size: 12px;">提权</a> <a href="/tags/服务/" style="font-size: 10px;">服务</a> <a href="/tags/权限/" style="font-size: 12px;">权限</a> <a href="/tags/栈溢出漏洞/" style="font-size: 10px;">栈溢出漏洞</a> <a href="/tags/测试/" style="font-size: 10px;">测试</a> <a href="/tags/漏洞调试/" style="font-size: 12px;">漏洞调试</a> <a href="/tags/生活/" style="font-size: 14px;">生活</a> <a href="/tags/脱壳/" style="font-size: 10px;">脱壳</a> <a href="/tags/西安/" style="font-size: 10px;">西安</a> <a href="/tags/计划/" style="font-size: 10px;">计划</a> <a href="/tags/读书/" style="font-size: 10px;">读书</a> <a href="/tags/调试/" style="font-size: 14px;">调试</a> <a href="/tags/转换/" style="font-size: 10px;">转换</a> <a href="/tags/进程/" style="font-size: 10px;">进程</a> <a href="/tags/逆向/" style="font-size: 10px;">逆向</a> <a href="/tags/重庆/" style="font-size: 10px;">重庆</a> <a href="/tags/驱动/" style="font-size: 14px;">驱动</a>
  </div>
</div>


  
  <div class="widget-wrap">
   <a href="https://curl.qcloud.com/MpoJ5iCM"> <img src="/img/ad.jpg" /> </a>
  </div>


  <div class="widget tag">
<h3 class="title">Links</h3>
<ul class="entry">
<li><a href="http://blog.ourren.com/" title="Ourren">Ourren</a></li>
<li><a href="http://www.hyjal.net/" title="Hyjal">Hyjal</a></li>
<li><a href="http://www.jianshu.com/users/fa15f4e416ae/latest_articles" title="Daemonceltics">Daemonceltics</a></li>
<li><a href="http://papap.info/" title="isee">isee</a></li>
</ul>
</div>

  <script type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=putG&d=yoFnN6V-ovhL-H4e9_69LvkTiX4uX7rEYJ15yL3G1Wg"></script>
</aside>
    <div class="clearfix"></div>
  </div>
  <div id="go-pg-top"><i class="icon-arrow-up"></i></div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2021 Lyon
  
</div>
<div class="clearfix"></div></footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/page.js"></script>

</body>

</html>